
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OIH Queries &#8212; The Ocean InfoHub Project and the development of the ODIS-architecture</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="OIH Editing Playground" href="OIH_Editor.html" />
    <link rel="prev" title="Indexing Concepts" href="OIH_IndexIntro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Ocean InfoHub Project and the development of the ODIS-architecture</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   The Ocean InfoHub Project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content.html">
   Structured Data on the Web
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../personas/persona.html">
   Personas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../publishing/publishing.html">
   Publisher
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../foundation/foundation.html">
   JSON-LD Foundation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Profiles
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/README.html">
   Thematic Patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/expinst/README.html">
   Core 1: Experts and Institutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/docs/README.html">
   Core 2: Documents
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/docs/maps.html">
   Core 3: Spatial Maps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/projects/README.html">
   Core 4: Projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/training/README.html">
   Core 5: Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/vessels/README.html">
   Core 6: Vessels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/spatial/README.html">
   Support 1: Spatial Geometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/services/README.html">
   Support 2: Services
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/terms/list.html">
   Support 3: Keywords &amp; Defined Terms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/languages/languages.html">
   Support 4: Languages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/sdg/index.html">
   Support 5: Linking To Principles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../thematics/identifier/id.html">
   Support 6: Identifier and Prov
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Aggregation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/index.html">
   Aggregator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/qstart.html">
   Indexing with Gleaner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/cliDocker/README.html">
   Gleaner CLI Docker
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/indexingservices.html">
   Indexing Services
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/dataservices.html">
   Data Services
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/user.html">
   Interfaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/graphpub.html">
   Graph First Approach
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/prov/README.html">
   Indexing Activity Prov
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../indexing/alternatives.html">
   Alternatives
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tooling
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   Tooling
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../openRefine/README.html">
     OpenRefine
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../openRefine/template.html">
       Generic Template
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../openRefine/projects.html">
       Sargassum Project Template
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="README.html">
     OIH Notebooks
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="OIH_IndexIntro.html">
       Indexing Concepts
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       OIH Queries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="OIH_Editor.html">
       OIH Editing Playground
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="OIH_GraphAnalytics.html">
       OIH Graph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="validation/OIH_Simple_SHACL.html">
       SHACL Simple Validation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="validation/OIH_SHACL.html">
       SHACL Validation on Object Store
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="Mapping/README.html">
       Mapping to Schema.org
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="Mapping/ISO19139mapping/ISOMap.html">
         Mapping - ISO 19139
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="Mapping/DCATmapping/dcatmapping.html">
         Mapping - DCAT
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="Exploration/README.html">
       Exploration
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
      <label for="toctree-checkbox-5">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="Exploration/GeoKGComplete/geocomplete.html">
         Geo KG Completion
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="Exploration/CA-DWR/CADWR.html">
         California DWR sprint
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="Exploration/MarinePrtcAPI.html">
         Marine Protected Areas API exploration
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="Exploration/SPREP.html">
         SPREP Data Testing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="Exploration/maspawio.html">
         Maspawio
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="Exploration/LDFeed/LDFeed.html">
         Marine Regions LD Feed
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Validation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../validation/README.html">
   Validation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Interfaces
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../users/referenceclient.html">
   Users
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../users/query.html">
   SPARQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../users/sparql.html">
   OIH SPARQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../users/apis.html">
   APIs
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../appendix/index.html">
   Appendix
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/annoyances.html">
     Known Issues
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/references.html">
     References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/registries.html">
     Registries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../appendix/vocabularies.html">
     Controlled Vocabularies
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tooling/notebooks/OIH_Queries.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/iodepo/odis-arch"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/iodepo/odis-arch/issues/new?title=Issue%20on%20page%20%2Ftooling/notebooks/OIH_Queries.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/iodepo/odis-arch/master?urlpath=lab/tree/book/tooling/notebooks/OIH_Queries.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/iodepo/odis-arch/blob/master/book/tooling/notebooks/OIH_Queries.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-and-inits">
   Setup and inits
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installs">
     Installs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     Imports
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#support-functions">
     Support Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#queries">
   Queries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-count">
     Simple Count
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predicate-counts">
     Predicate Counts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oih-base-query">
     OIH Base Query
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oih-gleaner-query">
     OIH Gleaner Query
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#query-for-prov">
   Query for prov
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feed-query">
   Feed query
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-breakdown">
   Types Breakdown
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="oih-queries">
<h1>OIH Queries<a class="headerlink" href="#oih-queries" title="Permalink to this headline">¶</a></h1>
<p>What follows are some example SPARQL queries used in OIH for the test interface</p>
<div class="section" id="setup-and-inits">
<h2>Setup and inits<a class="headerlink" href="#setup-and-inits" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installs">
<h3>Installs<a class="headerlink" href="#installs" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%capture</span>
<span class="c1">#@title</span>
<span class="o">!</span>pip install -q SPARQLWrapper
<span class="o">!</span>pip install -q cython
<span class="c1"># !pip install -q cartopy</span>
<span class="o">!</span>pip install -q geopandas
<span class="o">!</span>pip install -q <span class="nv">contextily</span><span class="o">==</span><span class="m">1</span>.0rc2
<span class="o">!</span>pip install -q pyshacl
<span class="o">!</span>pip install -q <span class="s1">&#39;PyLD&gt;=2.0.3&#39;</span>
<span class="o">!</span>pip install -q flatten_json
<span class="o">!</span>pip install -q <span class="s1">&#39;fsspec&gt;=0.3.3&#39;</span>
<span class="o">!</span>pip install -q s3fs
<span class="o">!</span>pip -q install SPARQLWrapper
<span class="c1"># !pip install -q boto3</span>
<span class="c1"># !pip install -q kglab</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">SPARQLWrapper</span> <span class="kn">import</span> <span class="n">SPARQLWrapper</span><span class="p">,</span> <span class="n">JSON</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">dask</span><span class="o">,</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">shapely</span>
<span class="c1"># import kglab as kg</span>

<span class="n">oih</span> <span class="o">=</span> <span class="s2">&quot;https://graph.collaborium.io/blazegraph/namespace/oih/sparql&quot;</span>
<span class="n">oihdev</span> <span class="o">=</span> <span class="s2">&quot;https://graph.collaborium.io/blazegraph/namespace/oihdev/sparql&quot;</span>
<span class="n">oihad</span> <span class="o">=</span> <span class="s2">&quot;https://graph.collaborium.io/blazegraph/namespace/aquadocs/sparql&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="support-functions">
<h3>Support Functions<a class="headerlink" href="#support-functions" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title</span>
<span class="k">def</span> <span class="nf">get_sparql_dataframe</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to convert SPARQL results into a Pandas data frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sparql</span> <span class="o">=</span> <span class="n">SPARQLWrapper</span><span class="p">(</span><span class="n">service</span><span class="p">)</span>
    <span class="n">sparql</span><span class="o">.</span><span class="n">setQuery</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">sparql</span><span class="o">.</span><span class="n">setReturnFormat</span><span class="p">(</span><span class="n">JSON</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sparql</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>

    <span class="n">processed_results</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">response</span><span class="p">)</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">processed_results</span><span class="p">[</span><span class="s1">&#39;head&#39;</span><span class="p">][</span><span class="s1">&#39;vars&#39;</span><span class="p">]</span>

    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">processed_results</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">][</span><span class="s1">&#39;bindings&#39;</span><span class="p">]:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">))</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="queries">
<h2>Queries<a class="headerlink" href="#queries" title="Permalink to this headline">¶</a></h2>
<p>What follows is a set of queries designed to provide a feel for the OIH graph</p>
<div class="section" id="simple-count">
<h3>Simple Count<a class="headerlink" href="#simple-count" title="Permalink to this headline">¶</a></h3>
<p>How many triples are there?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_count</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SELECT (COUNT(*) as ?Triples) </span>
<span class="s2">WHERE </span>
<span class="s2">  {</span>
<span class="s2">      { ?s ?p ?o } </span>
<span class="s2">  }</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfsc</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oih</span><span class="p">,</span> <span class="n">rq_count</span><span class="p">)</span>
<span class="n">dfsc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Triples</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>159766</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="predicate-counts">
<h3>Predicate Counts<a class="headerlink" href="#predicate-counts" title="Permalink to this headline">¶</a></h3>
<p>This gives an overview of unique predicates that connect a subject to an object.  This gives us both an idea of the properties we are using on things and count of their usage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_pcount</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SELECT ?p (COUNT(?p) as ?pCount)</span>
<span class="s2">WHERE</span>
<span class="s2">{</span>
<span class="s2">  ?s ?p ?o .</span>
<span class="s2">}</span>
<span class="s2">GROUP BY ?p</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfc</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oih</span><span class="p">,</span> <span class="n">rq_pcount</span><span class="p">)</span>
<span class="n">dfc</span><span class="p">[</span><span class="s1">&#39;pCount&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfc</span><span class="p">[</span><span class="s2">&quot;pCount&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># convert count to int</span>
<span class="c1"># dfc.set_index(&#39;p&#39;, inplace=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfc_sorted</span> <span class="o">=</span> <span class="n">dfc</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;pCount&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dfc_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>p</th>
      <th>pCount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>33</th>
      <td>http://www.w3.org/1999/02/22-rdf-syntax-ns#type</td>
      <td>32625</td>
    </tr>
    <tr>
      <th>5</th>
      <td>https://schema.org/keywords</td>
      <td>17359</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://schema.org/url</td>
      <td>14236</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://schema.org/name</td>
      <td>12594</td>
    </tr>
    <tr>
      <th>17</th>
      <td>https://schema.org/provider</td>
      <td>5136</td>
    </tr>
    <tr>
      <th>0</th>
      <td>https://schema.org/description</td>
      <td>4895</td>
    </tr>
    <tr>
      <th>6</th>
      <td>https://schema.org/sameAs</td>
      <td>4889</td>
    </tr>
    <tr>
      <th>27</th>
      <td>https://schema.org/legalName</td>
      <td>4823</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://schema.org/propertyID</td>
      <td>4265</td>
    </tr>
    <tr>
      <th>7</th>
      <td>https://schema.org/value</td>
      <td>4265</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rcount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfc_sorted</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rcount</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>34
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">dfc_sorted</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">38</span><span class="p">)[</span><span class="s1">&#39;pCount&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>159766
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs</span> <span class="o">=</span> <span class="n">dfc_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">hs</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="s1">&#39;Other&#39;</span><span class="p">,</span><span class="s1">&#39;pCount&#39;</span><span class="p">:</span><span class="n">ts</span><span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="c1"># hs.set_index(&#39;p&#39;, inplace=True)</span>
<span class="n">hs</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>p</th>
      <th>pCount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>33</th>
      <td>http://www.w3.org/1999/02/22-rdf-syntax-ns#type</td>
      <td>32625</td>
    </tr>
    <tr>
      <th>5</th>
      <td>https://schema.org/keywords</td>
      <td>17359</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://schema.org/url</td>
      <td>14236</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://schema.org/name</td>
      <td>12594</td>
    </tr>
    <tr>
      <th>17</th>
      <td>https://schema.org/provider</td>
      <td>5136</td>
    </tr>
    <tr>
      <th>0</th>
      <td>https://schema.org/description</td>
      <td>4895</td>
    </tr>
    <tr>
      <th>6</th>
      <td>https://schema.org/sameAs</td>
      <td>4889</td>
    </tr>
    <tr>
      <th>27</th>
      <td>https://schema.org/legalName</td>
      <td>4823</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://schema.org/propertyID</td>
      <td>4265</td>
    </tr>
    <tr>
      <th>7</th>
      <td>https://schema.org/value</td>
      <td>4265</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;pCount&#39;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/OIH_Queries_19_0.svg" src="../../_images/OIH_Queries_19_0.svg" /></div>
</div>
</div>
<div class="section" id="oih-base-query">
<h3>OIH Base Query<a class="headerlink" href="#oih-base-query" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_main</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;prefix prov: &lt;http://www.w3.org/ns/prov#&gt;</span>
<span class="s2">        PREFIX con: &lt;http://www.ontotext.com/connectors/lucene#&gt;</span>
<span class="s2">        PREFIX luc: &lt;http://www.ontotext.com/owlim/lucene#&gt;</span>
<span class="s2">        PREFIX con-inst: &lt;http://www.ontotext.com/connectors/lucene/instance#&gt;</span>
<span class="s2">        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span>
<span class="s2">        PREFIX schema: &lt;https://schema.org/&gt;</span>
<span class="s2">        PREFIX schemaold: &lt;http://schema.org/&gt;</span>
<span class="s2">        PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>

<span class="s2">        SELECT DISTINCT ?g  ?s   ?type ?score ?name ?url ?lit ?description ?headline</span>
<span class="s2">        WHERE</span>
<span class="s2">        {</span>
<span class="s2">           ?lit bds:search &quot;coral&quot; .</span>
<span class="s2">           ?lit bds:matchAllTerms &quot;false&quot; .</span>
<span class="s2">           ?lit bds:relevance ?score .</span>
<span class="s2">           graph ?g {</span>
<span class="s2">            ?s ?p ?lit .</span>
<span class="s2">            ?s rdf:type ?type . </span>
<span class="s2">            OPTIONAL { ?s schema:name ?name .   }</span>
<span class="s2">            OPTIONAL { ?s schema:headline ?headline .   }</span>
<span class="s2">            OPTIONAL { ?s schema:url ?url .   }</span>
<span class="s2">            OPTIONAL { ?s schema:description ?description .    }</span>
<span class="s2">          }</span>

<span class="s2">        }</span>
<span class="s2">        ORDER BY DESC(?score)</span>
<span class="s2">        LIMIT 30</span>
<span class="s2">        OFFSET 0</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oih</span><span class="p">,</span> <span class="n">rq_main</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>g</th>
      <th>s</th>
      <th>type</th>
      <th>score</th>
      <th>name</th>
      <th>url</th>
      <th>lit</th>
      <th>description</th>
      <th>headline</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>urn:gleaner:milled:obis:13392d707024cdd4e509d6...</td>
      <td>t670214</td>
      <td>https://schema.org/Dataset</td>
      <td>1.0</td>
      <td>Coral Reef Evaluation and Monitoring Project F...</td>
      <td>https://obis.org/dataset/b91d89db-79d6-4bd3-84...</td>
      <td>coral</td>
      <td>The purpose of the Coral Reef Evaluation and M...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>urn:gleaner:milled:obis:18d1180a74c200d06f9114...</td>
      <td>t671476</td>
      <td>https://schema.org/Dataset</td>
      <td>1.0</td>
      <td>Coral Reef Evaluation and Monitoring Project D...</td>
      <td>https://obis.org/dataset/46005357-02b8-4f17-b0...</td>
      <td>coral</td>
      <td>The purpose of the Coral Reef Evaluation and M...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>urn:gleaner:milled:obis:24bac898cda34444176ec4...</td>
      <td>t673848</td>
      <td>https://schema.org/Dataset</td>
      <td>1.0</td>
      <td>Coral Reef Evaluation and Monitoring Project F...</td>
      <td>https://obis.org/dataset/d4ec17b8-fc96-49b9-b7...</td>
      <td>coral</td>
      <td>The purpose of the Coral Reef Evaluation and M...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>urn:gleaner:milled:obis:24d453e3a4ea6d1f117e5c...</td>
      <td>t673875</td>
      <td>https://schema.org/Dataset</td>
      <td>1.0</td>
      <td>Coral Reef Evaluation and Monitoring Project F...</td>
      <td>https://obis.org/dataset/36bca81c-6d77-4fd4-a9...</td>
      <td>coral</td>
      <td>The purpose of the Coral Reef Evaluation and M...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>urn:gleaner:milled:obis:2bf98aa888d856b8706176...</td>
      <td>t675633</td>
      <td>https://schema.org/Dataset</td>
      <td>1.0</td>
      <td>Coral Reef Evaluation and Monitoring Project F...</td>
      <td>https://obis.org/dataset/431f96f7-521c-4182-ae...</td>
      <td>coral</td>
      <td>The purpose of the Coral Reef Evaluation and M...</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="oih-gleaner-query">
<h3>OIH Gleaner Query<a class="headerlink" href="#oih-gleaner-query" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_maingl</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;prefix prov: &lt;http://www.w3.org/ns/prov#&gt;</span>
<span class="s2">        PREFIX con: &lt;http://www.ontotext.com/connectors/lucene#&gt;</span>
<span class="s2">        PREFIX luc: &lt;http://www.ontotext.com/owlim/lucene#&gt;</span>
<span class="s2">        PREFIX con-inst: &lt;http://www.ontotext.com/connectors/lucene/instance#&gt;</span>
<span class="s2">        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span>
<span class="s2">        PREFIX schema: &lt;https://schema.org/&gt;</span>
<span class="s2">        PREFIX schemaold: &lt;http://schema.org/&gt;</span>
<span class="s2">        PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>

<span class="s2">        SELECT DISTINCT ?g  ?s  ?wat ?orgname ?domain ?type ?score ?name ?url ?lit ?description ?headline</span>
<span class="s2">        WHERE</span>
<span class="s2">        {</span>
<span class="s2">           ?lit bds:search &quot;coral&quot; .</span>
<span class="s2">           ?lit bds:matchAllTerms &quot;false&quot; .</span>
<span class="s2">           ?lit bds:relevance ?score .</span>
<span class="s2">           graph ?g {</span>
<span class="s2">            ?s ?p ?lit .</span>
<span class="s2">            ?s rdf:type ?type . </span>
<span class="s2">            OPTIONAL { ?s schema:name ?name .   }</span>
<span class="s2">            OPTIONAL { ?s schema:headline ?headline .   }</span>
<span class="s2">            OPTIONAL { ?s schema:url ?url .   }</span>
<span class="s2">            OPTIONAL { ?s schema:description ?description .    }</span>
<span class="s2">          }</span>
<span class="s2">           ?sp prov:generated ?g  .</span>
<span class="s2">           ?sp prov:used ?used .</span>
<span class="s2">           ?used prov:hadMember ?hm .</span>
<span class="s2">           ?hm prov:wasAttributedTo ?wat .</span>
<span class="s2">           ?wat rdf:name ?orgname .</span>
<span class="s2">           ?wat rdfs:seeAlso ?domain</span>
<span class="s2">        }</span>
<span class="s2">        ORDER BY DESC(?score)</span>
<span class="s2">        LIMIT 30</span>
<span class="s2">        OFFSET 0</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oihad</span><span class="p">,</span> <span class="n">rq_maingl</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>g</th>
      <th>s</th>
      <th>wat</th>
      <th>orgname</th>
      <th>domain</th>
      <th>type</th>
      <th>score</th>
      <th>name</th>
      <th>url</th>
      <th>lit</th>
      <th>description</th>
      <th>headline</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>urn:gleaner:milled:obis:c18f3c68e05fc5820e5daf...</td>
      <td>t3333357</td>
      <td>https://www.re3data.org/repository/obis</td>
      <td>Ocean Biodiversity Information System</td>
      <td>https://obis.org</td>
      <td>https://schema.org/Dataset</td>
      <td>1.0</td>
      <td>Nematoda from Kenya and Zanzibar</td>
      <td>https://obis.org/dataset/aa9787d6-c4db-4fde-8e...</td>
      <td>Coral</td>
      <td>Data on the species and trophic composition of...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>urn:gleaner:milled:obis:4411c25cf985f8253c0a13...</td>
      <td>t3323787</td>
      <td>https://www.re3data.org/repository/obis</td>
      <td>Ocean Biodiversity Information System</td>
      <td>https://obis.org</td>
      <td>https://schema.org/Dataset</td>
      <td>1.0</td>
      <td>Kenyan reef corals sampled in November 1990</td>
      <td>https://obis.org/dataset/447b61a2-4a04-4394-af...</td>
      <td>Coral</td>
      <td>This dataset contains a taxonomic list of cora...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>urn:gleaner:summoned:aquadocs:bac548e654f7097a...</td>
      <td>oai:aquadocs.org:1834/1987</td>
      <td>https://www.re3data.org/repository/aquadocs</td>
      <td>AquaDocs</td>
      <td>https://aquadocs.org</td>
      <td>https://schema.org/CreativeWork</td>
      <td>1.0</td>
      <td>Is competition for space between the encrustin...</td>
      <td>https://www.oceandocs.org/handle/1834/1987</td>
      <td>Coral</td>
      <td>- Temperaturas del agua de mar por encima del...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>urn:gleaner:summoned:aquadocs:bac548e654f7097a...</td>
      <td>oai:aquadocs.org:1834/10551</td>
      <td>https://www.re3data.org/repository/aquadocs</td>
      <td>AquaDocs</td>
      <td>https://aquadocs.org</td>
      <td>https://schema.org/CreativeWork</td>
      <td>1.0</td>
      <td>Study of biotic communities for artificial ree...</td>
      <td>https://www.oceandocs.org/handle/1834/10551</td>
      <td>Coral</td>
      <td>- Persian Gulf waters (Hormuzgan Province) we...</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>urn:gleaner:summoned:aquadocs:bac548e654f7097a...</td>
      <td>oai:aquadocs.org:1834/12281</td>
      <td>https://www.re3data.org/repository/aquadocs</td>
      <td>AquaDocs</td>
      <td>https://aquadocs.org</td>
      <td>https://schema.org/CreativeWork</td>
      <td>1.0</td>
      <td>Molecular diversity of Symbiodinium spp. withi...</td>
      <td>https://www.oceandocs.org/handle/1834/12281</td>
      <td>Coral</td>
      <td>- Reef-building coral harbor communities of p...</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="query-for-prov">
<h2>Query for prov<a class="headerlink" href="#query-for-prov" title="Permalink to this headline">¶</a></h2>
<p>Count (count(distinct ?tag) as ?count)</p>
<p>Need to look for the date in the prov record too.  I keep it by day granularity, so I should be able to see the difference if I focos on a specific repo or look over the dates</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_prov</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;prefix prov: &lt;http://www.w3.org/ns/prov#&gt;</span>
<span class="s2">        PREFIX con: &lt;http://www.ontotext.com/connectors/lucene#&gt;</span>
<span class="s2">        PREFIX luc: &lt;http://www.ontotext.com/owlim/lucene#&gt;</span>
<span class="s2">        PREFIX con-inst: &lt;http://www.ontotext.com/connectors/lucene/instance#&gt;</span>
<span class="s2">        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span>
<span class="s2">        PREFIX schema: &lt;https://schema.org/&gt;</span>
<span class="s2">        PREFIX schemaold: &lt;http://schema.org/&gt;</span>
<span class="s2">        PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>

<span class="s2">       SELECT   ( COUNT(?hm) as ?count) ?wat  ?orgname ?domain</span>
<span class="s2">        WHERE</span>
<span class="s2">        {</span>
<span class="s2">           ?hm prov:wasAttributedTo ?wat .</span>
<span class="s2">           ?wat rdf:name ?orgname .</span>
<span class="s2">           ?wat rdfs:seeAlso ?domain</span>
<span class="s2">        }</span>
<span class="s2">        GROUP BY ?wat ?orgname ?domain</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_prov2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;prefix prov: &lt;http://www.w3.org/ns/prov#&gt;</span>
<span class="s2">        PREFIX con: &lt;http://www.ontotext.com/connectors/lucene#&gt;</span>
<span class="s2">        PREFIX luc: &lt;http://www.ontotext.com/owlim/lucene#&gt;</span>
<span class="s2">        PREFIX con-inst: &lt;http://www.ontotext.com/connectors/lucene/instance#&gt;</span>
<span class="s2">        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span>
<span class="s2">        PREFIX schema: &lt;https://schema.org/&gt;</span>
<span class="s2">        PREFIX schemaold: &lt;http://schema.org/&gt;</span>
<span class="s2">        PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>

<span class="s2">        SELECT ( COUNT(?s) as ?count) ?wat  ?orgname ?domain</span>
<span class="s2">        WHERE</span>
<span class="s2">        {</span>
<span class="s2">           graph ?g {</span>
<span class="s2">             VALUES (?type) { ( schema:CreativeWork ) ( schema:Map )  ( schema:Person )  ( schema:Organization )  ( schema:Dataset )  ( schema:Course ) } </span>
<span class="s2">            ?s rdf:type ?type . </span>
<span class="s2">            OPTIONAL { ?s schema:name ?name .   }</span>
<span class="s2">            OPTIONAL { ?s schema:headline ?headline .   }</span>
<span class="s2">            OPTIONAL { ?s schema:url ?url .   }</span>
<span class="s2">            OPTIONAL { ?s schema:description ?description .    }</span>
<span class="s2">          }</span>
<span class="s2">           ?sp prov:generated ?g  .</span>
<span class="s2">           ?sp prov:used ?used .</span>
<span class="s2">           ?used prov:hadMember ?hm .</span>
<span class="s2">           ?hm prov:wasAttributedTo ?wat .</span>
<span class="s2">           ?wat rdf:name ?orgname .</span>
<span class="s2">           ?wat rdfs:seeAlso ?domain</span>
<span class="s2">        }</span>
<span class="s2">                GROUP BY ?wat ?orgname ?domain</span>

<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfp</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oihad</span><span class="p">,</span> <span class="n">rq_prov2</span><span class="p">)</span>
<span class="n">dfp</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfp</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># convert count c to int</span>
<span class="n">dfp</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;orgname&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dfp</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>wat</th>
      <th>domain</th>
    </tr>
    <tr>
      <th>orgname</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Marine Training EU</th>
      <td>944</td>
      <td>https://www.re3data.org/repository/marinetraining</td>
      <td>https://marinetraining.eu/</td>
    </tr>
    <tr>
      <th>Ocean Biodiversity Information System</th>
      <td>9036</td>
      <td>https://www.re3data.org/repository/obis</td>
      <td>https://obis.org</td>
    </tr>
    <tr>
      <th>OceanExpert UNESCO/IOC Project Office for IODE</th>
      <td>502</td>
      <td>https://www.re3data.org/repository/oceanexpert</td>
      <td>https://oceanexpert.org/</td>
    </tr>
    <tr>
      <th>Ocean Best Practices</th>
      <td>8223</td>
      <td>https://www.re3data.org/repository/obps</td>
      <td>https://oih.oceanbestpractices.org</td>
    </tr>
    <tr>
      <th>AquaDocs</th>
      <td>155498</td>
      <td>https://www.re3data.org/repository/aquadocs</td>
      <td>https://aquadocs.org</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">dfp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/OIH_Queries_30_0.png" src="../../_images/OIH_Queries_30_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_provdate</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;prefix prov: &lt;http://www.w3.org/ns/prov#&gt;</span>
<span class="s2">        PREFIX con: &lt;http://www.ontotext.com/connectors/lucene#&gt;</span>
<span class="s2">        PREFIX luc: &lt;http://www.ontotext.com/owlim/lucene#&gt;</span>
<span class="s2">        PREFIX con-inst: &lt;http://www.ontotext.com/connectors/lucene/instance#&gt;</span>
<span class="s2">        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span>
<span class="s2">        PREFIX schema: &lt;https://schema.org/&gt;</span>
<span class="s2">        PREFIX schemaold: &lt;http://schema.org/&gt;</span>
<span class="s2">        PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>

<span class="s2"> </span>
<span class="s2">       SELECT   ( COUNT(?s) as ?count) ?time ?orgname  </span>
<span class="s2">        WHERE</span>
<span class="s2">        {</span>
<span class="s2">           ?s a prov:Activity  .</span>
<span class="s2">           ?s prov:endedAtTime ?time .</span>
<span class="s2">           ?s prov:generated ?gen .</span>
<span class="s2">           ?s prov:used ?used .</span>
<span class="s2">           ?used prov:hadMember ?mem .</span>
<span class="s2">           ?mem prov:wasAttributedTo ?wat .</span>
<span class="s2">           ?wat rdf:name ?orgname .</span>
<span class="s2">           ?wat rdfs:seeAlso ?domain</span>
<span class="s2">        }</span>
<span class="s2">        GROUP BY ?time ?orgname  </span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfpd</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oihad</span><span class="p">,</span> <span class="n">rq_provdate</span><span class="p">)</span>
<span class="n">dfpd</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>time</th>
      <th>orgname</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>314</td>
      <td>2021-08-09T00:00:00.000Z</td>
      <td>Marine Training EU</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4214</td>
      <td>2021-08-09T00:00:00.000Z</td>
      <td>Ocean Biodiversity Information System</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>2021-08-09T00:00:00.000Z</td>
      <td>Ocean Best Practices</td>
    </tr>
    <tr>
      <th>3</th>
      <td>502</td>
      <td>2021-08-09T00:00:00.000Z</td>
      <td>OceanExpert UNESCO/IOC Project Office for IODE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2021-08-09T00:00:00.000Z</td>
      <td>AquaDocs</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfpd</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oihad</span><span class="p">,</span> <span class="n">rq_provdate</span><span class="p">)</span>
<span class="n">dfpd</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfpd</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># convert count c to int</span>
<span class="n">dfpd</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dfpd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>orgname</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2021-08-09T00:00:00.000Z</th>
      <td>314</td>
      <td>Marine Training EU</td>
    </tr>
    <tr>
      <th>2021-08-09T00:00:00.000Z</th>
      <td>4214</td>
      <td>Ocean Biodiversity Information System</td>
    </tr>
    <tr>
      <th>2021-07-31T00:00:00.000Z</th>
      <td>1</td>
      <td>AquaDocs</td>
    </tr>
    <tr>
      <th>2021-07-30T00:00:00.000Z</th>
      <td>2</td>
      <td>Ocean Best Practices</td>
    </tr>
    <tr>
      <th>2021-07-31T00:00:00.000Z</th>
      <td>2</td>
      <td>Ocean Best Practices</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">dfpd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/OIH_Queries_34_0.png" src="../../_images/OIH_Queries_34_0.png" />
</div>
</div>
</div>
<div class="section" id="feed-query">
<h2>Feed query<a class="headerlink" href="#feed-query" title="Permalink to this headline">¶</a></h2>
<p>Goal here is see if the prov will give us the elements for an RSS feed.<br />
The <a class="reference external" href="https://validator.w3.org/feed/docs/rss2.html">RSS specs</a> give us the elements we need to populate.  Focus on; title(name), date, author, description</p>
<ul class="simple">
<li><p>Element 	Description 	Example</p></li>
<li><p>title 	The title of the item. 	Venice Film Festival Tries to Quit Sinking</p></li>
<li><p>link 	The URL of the item. 	<a class="reference external" href="http://www.nytimes.com/2002/09/07/movies/07FEST.html">http://www.nytimes.com/2002/09/07/movies/07FEST.html</a></p></li>
<li><p>description 	The item synopsis. 	Some of the most heated chatter at the Venice Film Festival this week was about the way that the arrival of the stars at the Palazzo del Cinema was being staged.</p></li>
<li><p>author 	Email address of the author of the item. More. 	<a class="reference external" href="mailto:oprah&#37;&#52;&#48;oxygen&#46;net">oprah<span>&#64;</span>oxygen<span>&#46;</span>net</a></p></li>
<li><p>category 	Includes the item in one or more categories. More. 	Simpsons Characters</p></li>
<li><p>comments 	URL of a page for comments relating to the item. More. 	<a class="reference external" href="http://www.myblog.org/cgi-local/mt/mt-comments.cgi?entry_id=290">http://www.myblog.org/cgi-local/mt/mt-comments.cgi?entry_id=290</a></p></li>
<li><p>enclosure 	Describes a media object that is attached to the item. More. 	<enclosure url="http://live.curry.com/mp3/celebritySCms.mp3" length="1069871" type="audio/mpeg"/></p></li>
<li><p>guid 	A string that uniquely identifies the item. More. 	<guid isPermaLink="true"><a class="reference external" href="http://inessential.com/2002/09/01.php#a2">http://inessential.com/2002/09/01.php#a2</a></guid></p></li>
<li><p>pubDate 	Indicates when the item was published. More. 	Sun, 19 May 2002 15:21:36 GMT</p></li>
<li><p>source 	The RSS channel that the item came from. More. 	<source url="http://www.quotationspage.com/data/qotd.rss">Quotes of the Day</source></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_provdatelist</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;prefix prov: &lt;http://www.w3.org/ns/prov#&gt;</span>
<span class="s2">        PREFIX con: &lt;http://www.ontotext.com/connectors/lucene#&gt;</span>
<span class="s2">        PREFIX luc: &lt;http://www.ontotext.com/owlim/lucene#&gt;</span>
<span class="s2">        PREFIX con-inst: &lt;http://www.ontotext.com/connectors/lucene/instance#&gt;</span>
<span class="s2">        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span>
<span class="s2">        PREFIX schema: &lt;https://schema.org/&gt;</span>
<span class="s2">        PREFIX schemaold: &lt;http://schema.org/&gt;</span>
<span class="s2">        PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>

<span class="s2">       SELECT  ?time ?orgname ?memval  ?memname ?memdesc</span>
<span class="s2">        WHERE</span>
<span class="s2">        {</span>
<span class="s2">           ?s a prov:Activity  .</span>
<span class="s2">           ?s prov:endedAtTime ?time .</span>
<span class="s2">           ?s prov:generated ?gen .</span>
<span class="s2">           ?s prov:used ?used .</span>
<span class="s2">           ?used prov:hadMember ?mem .</span>
<span class="s2">           ?mem prov:value ?memval .</span>
<span class="s2">           ?mem schema:name ?memname .</span>
<span class="s2">           ?mem schema:description ?memdesc .</span>
<span class="s2">           ?mem prov:wasAttributedTo ?wat .</span>
<span class="s2">           ?wat rdf:name ?orgname .</span>
<span class="s2">           ?wat rdfs:seeAlso ?domain</span>
<span class="s2">        }</span>
<span class="s2">        ORDER BY DESC(?time)</span>
<span class="s2">        LIMIT 1000</span>

<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfpl</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oih</span><span class="p">,</span> <span class="n">rq_provdatelist</span><span class="p">)</span>
<span class="n">dfpl</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>orgname</th>
      <th>memval</th>
      <th>memname</th>
      <th>memdesc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4059</td>
      <td>Coastal Benthic Ecology</td>
      <td>Contents\n\nThe course provides a thorough int...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4191</td>
      <td>Methods for Implementation of Surveillance Pro...</td>
      <td>General course objectives\n\nThe course aims t...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4347</td>
      <td>Adaptation Planning</td>
      <td>Course Description:\n\nThe course examines cha...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4158</td>
      <td>Business Development and Innovation (Aquatic R...</td>
      <td>General course objectives\n\nThe objective of ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/3910</td>
      <td>Machine Vision</td>
      <td>Course content\n\nIntroduction to machine visi...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4332</td>
      <td>Arctic Ocean Governance</td>
      <td>Course Description:\n\nThe course will discuss...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4115</td>
      <td>Mathematical Biology</td>
      <td>General course objectives\n\nThe course is an ...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4094</td>
      <td>Methodology and Sampling in Environmental Mana...</td>
      <td>Practical sampling of soil, water and bioindic...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4343</td>
      <td>Global Fisheries and Seafood</td>
      <td>Course Description:\n\nThe course offers a det...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2021-05-12T00:00:00.000Z</td>
      <td>Marine Training EU</td>
      <td>https://www.marinetraining.eu/node/4139</td>
      <td>Biological Oceanography</td>
      <td>General course objectives\n\nBiological oceano...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="types-breakdown">
<h2>Types Breakdown<a class="headerlink" href="#types-breakdown" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rq_types</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;prefix prov: &lt;http://www.w3.org/ns/prov#&gt;</span>
<span class="s2">        PREFIX con: &lt;http://www.ontotext.com/connectors/lucene#&gt;</span>
<span class="s2">        PREFIX luc: &lt;http://www.ontotext.com/owlim/lucene#&gt;</span>
<span class="s2">        PREFIX con-inst: &lt;http://www.ontotext.com/connectors/lucene/instance#&gt;</span>
<span class="s2">        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;</span>
<span class="s2">        PREFIX schema: &lt;https://schema.org/&gt;</span>
<span class="s2">        PREFIX schemaold: &lt;http://schema.org/&gt;</span>
<span class="s2">        PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;</span>

<span class="s2"> </span>
<span class="s2">       SELECT   ( COUNT(?type) as ?count) ?type   </span>
<span class="s2">        WHERE</span>
<span class="s2">        {</span>
<span class="s2">           ?s rdf:type ?type</span>
<span class="s2">        }</span>
<span class="s2">        GROUP BY ?type  </span>
<span class="s2">        ORDER BY DESC(?count)</span>
<span class="s2">        &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dft</span> <span class="o">=</span> <span class="n">get_sparql_dataframe</span><span class="p">(</span><span class="n">oihad</span><span class="p">,</span> <span class="n">rq_types</span><span class="p">)</span>
<span class="n">dft</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dft</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># convert count c to int</span>
<span class="n">dft</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dft</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>type</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>https://schema.org/Person</th>
      <td>107563</td>
    </tr>
    <tr>
      <th>https://schema.org/PropertyValue</th>
      <td>44658</td>
    </tr>
    <tr>
      <th>https://schema.org/CreativeWork</th>
      <td>40389</td>
    </tr>
    <tr>
      <th>https://schema.org/ListItem</th>
      <td>40387</td>
    </tr>
    <tr>
      <th>https://schema.org/Organization</th>
      <td>21224</td>
    </tr>
    <tr>
      <th>http://www.w3.org/ns/prov#Entity</th>
      <td>10064</td>
    </tr>
    <tr>
      <th>http://www.w3.org/ns/prov#Activity</th>
      <td>5032</td>
    </tr>
    <tr>
      <th>http://www.w3.org/ns/prov#Collection</th>
      <td>5032</td>
    </tr>
    <tr>
      <th>http://www.w3.org/ns/prov#Organization</th>
      <td>5032</td>
    </tr>
    <tr>
      <th>https://schema.org/Place</th>
      <td>4848</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_t</span> <span class="o">=</span> <span class="n">dft</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/OIH_Queries_41_0.png" src="../../_images/OIH_Queries_41_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tooling/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="OIH_IndexIntro.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Indexing Concepts</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="OIH_Editor.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">OIH Editing Playground</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By IODEPO<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>