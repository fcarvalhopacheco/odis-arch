
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Indexing with Gleaner &#8212; The Ocean InfoHub Project and the development of the ODIS-architecture</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Indexing Services" href="indexingservices.html" />
    <link rel="prev" title="Aggregator" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Ocean InfoHub Project and the development of the ODIS-architecture</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   The Ocean InfoHub Project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../content.html">
   Structured Data on the Web
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../personas/persona.html">
   Personas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../publishing/publishing.html">
   Publisher
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../foundation/foundation.html">
   JSON-LD Foundation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Profiles
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/README.html">
   Thematic Patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/expinst/README.html">
   Core 1: Experts and Institutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/docs/README.html">
   Core 2: Documents
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/docs/maps.html">
   Core 3: Spatial Maps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/projects/README.html">
   Core 4: Projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/training/README.html">
   Core 5: Training
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/vessels/README.html">
   Core 6: Vessels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/spatial/README.html">
   Support 1: Spatial Geometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/services/README.html">
   Support 2: Services
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/terms/list.html">
   Support 3: Lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/languages/languages.html">
   Support 4: Languages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/sdg/index.html">
   Support 5: Linking To Principles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../thematics/identifier/id.html">
   Support 6: Identifier pattern
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Aggregation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Aggregator
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Indexing with Gleaner
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexingservices.html">
   Indexing Services
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dataservices.html">
   Data Services
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="user.html">
   Interfaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="graphpub.html">
   Graph First Approach
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prov/README.html">
   Indexing Activity Prov
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="alternatives.html">
   Alternatives
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tooling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tooling/index.html">
   Tooling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../tooling/openRefine/README.html">
     OpenRefine
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../tooling/openRefine/template.html">
       Generic Template
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tooling/openRefine/projects.html">
       Sargassum Project Template
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../tooling/notebooks/README.html">
     OIH Notebooks
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../tooling/notebooks/OIH_GraphAnalytics.html">
       Graph Analytics Exploration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tooling/notebooks/OIH_Queries.html">
       OIH Queries
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tooling/notebooks/OIH_Editor.html">
       OIH Editor Playground
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tooling/notebooks/validation/OIH_SHACL.html">
       SHACL validation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tooling/notebooks/ISO19139mapping/ISOMap.html">
       ISO 19139 To Schema.org
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../tooling/notebooks/DCATmapping/dcatmapping.html">
       Mapping
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../tooling/notebooks/geoKGComplete/README.html">
       Georeference KG completion example
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../tooling/notebooks/geoKGComplete/geocomplete.html">
         Geospatial KG Completion
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Validation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../validation/README.html">
   Validation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Interfaces
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../users/referenceclient.html">
   Users
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../users/sparql.html">
   Querying SPARQL
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../appendix/index.html">
   Appendix
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../appendix/annoyances.html">
     Known Issues
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../appendix/references.html">
     References
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../appendix/registries.html">
     Registries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../appendix/vocabularies.html">
     Controlled Vocabularies
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/indexing/qstart.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/iodepo/odis-arch"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/iodepo/odis-arch/issues/new?title=Issue%20on%20page%20%2Findexing/qstart.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gleaner-app">
   Gleaner (app)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quick-start-steps">
     Quick Start steps
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#grab-gleaner-and-the-support-files-we-need">
       Grab Gleaner and the support files we need
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#about-the-compose-file-s">
       About the compose file(s)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#edit-environment-variables-setup-script">
       Edit environment variables setup script
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spin-up-the-containers">
       Spin up the containers
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#edit-gleaner-config-file">
       Edit Gleaner config file
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#run-gleaner">
       Run gleaner
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-results-to-a-graph-and-test">
     Load results to a graph and test
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minio-object-store">
       Minio Object store
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#load-triplestore">
       Load Triplestore
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="indexing-with-gleaner">
<h1>Indexing with Gleaner<a class="headerlink" href="#indexing-with-gleaner" title="Permalink to this headline">¶</a></h1>
<p><img alt="compose options" src="../_images/composeOptions.png" /></p>
<div class="section" id="gleaner-app">
<h2>Gleaner (app)<a class="headerlink" href="#gleaner-app" title="Permalink to this headline">¶</a></h2>
<p>The Gleaner applications performs the retrieval and loading of JSON-LD documents
from the web following structured data on the web patterns.  Gleaner is available for Linux, Mac OS X and Windows.</p>
<p>While Gleaner is a stand alone app, it needs to interact with
an object store to support data storage and other operations.  These dependencies are met within the
Gleaner Indexing Services or Data Service Docker compose files.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This documentation is in development.  The primary testing environments are Linux and other UNIX based platforms
such as Mac OS X.   If you are on Windows, there may be some issues.  If you can use a Linux subsystem on Windows,
you may experience better results.  We will test with Windows eventually and update documentation as needed.</p>
</div>
<div class="section" id="quick-start-steps">
<h3>Quick Start steps<a class="headerlink" href="#quick-start-steps" title="Permalink to this headline">¶</a></h3>
<p>This quick start guide is focused on setting up and testing Gleaner in a local environnement.  It is similar to
how you might run Gleaner in a production environment but lacks the routing and other features likely desired for
such a situation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This documentation assumes a basic understanding of Docker and experience with basic Docker activities like
starting and stopping containers.  It also assumes an understanding of using a command line interface and
editing configuration files in the YAML format.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<p>From this point down, the documentation will attempt to put all commands
you should issue in this admonition style box.</p>
</div>
<p>In the end, this is the table of applications and config files you will need.  In this guide we will go through
downloading, setting them up and running Gleaner to index documents from the web.</p>
<table class="table" id="id1">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Required Applications and Config Files</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Gleaner</p></th>
<th class="head"><p>Docker</p></th>
<th class="head"><p>Minio Client</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>config.yaml</p></td>
<td><p><a class="reference external" href="http://setenv.sh">setenv.sh</a></p></td>
<td><p><a class="reference external" href="http://load2blaze.sh">load2blaze.sh</a></p></td>
</tr>
<tr class="row-odd"><td><p>schemaorg-current-https.jsonld</p></td>
<td><p>gleaner-DS-NoRouter.yml</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="section" id="grab-gleaner-and-the-support-files-we-need">
<h4>Grab Gleaner and the support files we need<a class="headerlink" href="#grab-gleaner-and-the-support-files-we-need" title="Permalink to this headline">¶</a></h4>
<p>We will need to get the Gleaner binary for your platform and also the Gleaner configuration file
template.  To do this, visit the <a class="reference external" href="https://github.com/earthcubearchitecture-project418/gleaner/releases">Gleaner Releases page </a>
and pick the release <em>Ocean InfoHubdev rc1</em>.  Under the <em>Assets</em> drop down you should see the files we need.  Get:</p>
<ul class="simple">
<li><p>Gleaner for your platform</p></li>
<li><p>Gleaner config template: template_v2.0.yaml</p></li>
<li><p>Gleaner indexing service compose file: gleaner-IS.yml</p></li>
<li><p>Helper environment setup script: <a class="reference external" href="http://setenvIS.sh">setenvIS.sh</a></p></li>
</ul>
<p>For this demonstration, we will be running on linux, so this would look something like:</p>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -L -O https://github.com/earthcubearchitecture-project418/gleaner/releases/download/2.0.25/gleaner
curl -L -O https://github.com/earthcubearchitecture-project418/gleaner/releases/download/2.0.25/gleaner-IS.yml
curl -L -O https://github.com/earthcubearchitecture-project418/gleaner/releases/download/2.0.25/setenvIS.sh
curl -L -O https://github.com/earthcubearchitecture-project418/gleaner/releases/download/2.0.25/template_v2.0.yaml
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can download these with any tool you wish or through the browser.  Above we downloaded used the command
line curl tool.  For GitHub, be sure to add the -L to inform curl to follow redirects to the object to download.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<p>You may need to change the permission on your gleaner file to ensure it can be run.   On Linux this would
look something like the following.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chmod <span class="m">755</span> gleaner
</pre></div>
</div>
</div>
<p>We then need to visit <a class="reference external" href="https://schema.org/docs/developers.html">Schema.org for Developers</a> to pull down the
appropriate JSON-LD context.  For this work we will want to pull down the <em>schemaorg-current-https</em> in JSON-LD format.<br />
It also should work to do something similar to the following:</p>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -O https://schema.org/version/latest/schemaorg-current-https.jsonld
</pre></div>
</div>
</div>
</div>
<div class="section" id="about-the-compose-file-s">
<h4>About the compose file(s)<a class="headerlink" href="#about-the-compose-file-s" title="Permalink to this headline">¶</a></h4>
<p>The above steps have collected the resources for the indexer.   We now want to set up the services that
Gleaner will use to perform the indexing.  To do that we use Docker or an appropriate run time alternative like
Podman or others.   For this example, we will assume you are using the Docker client.</p>
<p>As noted, a basic understanding of Docker and the ability to issue Docker cli commands to start and stop
containers is required. If you are new do Docker, we recommend you visit and read:
<a class="reference external" href="https://www.docker.com/get-started">Get Started with Docker</a>.</p>
<p>We need to select the type of services we wish to run.  The various versions of these Docker compose
file can be found in the <a class="reference external" href="https://github.com/gleanerio/gleaner-compose/tree/master/deployment">Gleaner-compose deployment directory</a>.</p>
<p>Why pick one over the other?</p>
<blockquote>
<div><p>Choose Gleaner IS if you simply wish to retrieve the JSON-LD into a data warehouse to use in your own workflows</p>
</div></blockquote>
<blockquote>
<div><p>Choose Gleaner DS if you wish to build out a graph and want to use the default contains used by Gleaner.</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We wont look at this file in detail here since there will hopefully be no
required edits.  You can see the file in detail in the Index Services
section.</p>
</div>
</div>
<div class="section" id="edit-environment-variables-setup-script">
<h4>Edit environment variables setup script<a class="headerlink" href="#edit-environment-variables-setup-script" title="Permalink to this headline">¶</a></h4>
<p>We have Docker and the appropriate compose file.  The compose files require a set of environment variables
to be populated to provide the local hosts information needed to run.  You can set these yourself or
use or reference the <a class="reference external" href="http://setenv.sh">setenv.sh</a> file in the Gleaner-compose repository in the<br />
<a class="reference external" href="https://github.com/gleanerio/gleaner-compose/tree/master/deployment">Gleaner-compose deployment directory</a>.
You may also need to visit information about permissions at
<a class="reference external" href="https://docs.docker.com/engine/install/linux-postinstall/">Post-installation steps for Linux</a> if you are
having permission issues.</p>
<p>Let’s take a look at the script.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>#!/bin/bash

# Object store keys
export MINIO_ACCESS_KEY=worldsbestaccesskey
export MINIO_SECRET_KEY=worldsbestsecretkey

# local data volumes
export GLEANER_BASE=/tmp/gleaner/
mkdir --parents ${GLEANER_BASE}
export GLEANER_OBJECTS=${GLEANER_BASE}/datavol/s3
export GLEANER_GRAPH=${GLEANER_BASE}/datavol/graph

</pre></div>
</td></tr></table></div>
<p>You may wish to edit file to work better with your environment.  By default it will attempt to
use localhost to resolve with and host local runtime data in a /tmp/gleaner directory.</p>
</div>
<div class="section" id="spin-up-the-containers">
<h4>Spin up the containers<a class="headerlink" href="#spin-up-the-containers" title="Permalink to this headline">¶</a></h4>
<p>Load our environment variables to the shell:</p>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> setenv.sh
</pre></div>
</div>
</div>
<p>Then start the containers:</p>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker-compose -f gleaner-IS.yml up -d
</pre></div>
</div>
</div>
<p>If all has gone well, you should be able to see your running containers with</p>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker ps
</pre></div>
</div>
</div>
<p>and see results similar to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CONTAINER ID        IMAGE                            COMMAND                  CREATED             STATUS              PORTS                    NAMES
c4b7097f5e06        nawer/blazegraph                 <span class="s2">&quot;docker-entrypoint.s…&quot;</span>   <span class="m">8</span> seconds ago       Up <span class="m">7</span> seconds        <span class="m">0</span>.0.0.0:9999-&gt;9999/tcp   test_triplestore_1
ca08c24963a0        minio/minio:latest               <span class="s2">&quot;/usr/bin/docker-ent…&quot;</span>   <span class="m">8</span> seconds ago       Up <span class="m">7</span> seconds        <span class="m">0</span>.0.0.0:9000-&gt;9000/tcp   test_s3system_1
24274eba0d34        chromedp/headless-shell:latest   <span class="s2">&quot;/headless-shell/hea…&quot;</span>   <span class="m">8</span> seconds ago       Up <span class="m">7</span> seconds        <span class="m">0</span>.0.0.0:9222-&gt;9222/tcp   test_headless_1
</pre></div>
</div>
</div>
<div class="section" id="edit-gleaner-config-file">
<h4>Edit Gleaner config file<a class="headerlink" href="#edit-gleaner-config-file" title="Permalink to this headline">¶</a></h4>
<p>We have all the files we need and we have our support services running.  The next and
final step is to edit our Gleaner configuration file.  This will let Gleaner know
the location of the support services, the JSON-LD context file and the locations
of the resources we wish to index.</p>
<p>Let’s take a look at the configuration file and then break down each section.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">---</span>
<span class="n">minio</span><span class="p">:</span>
  <span class="n">address</span><span class="p">:</span> <span class="mf">0.0.0.0</span>
  <span class="n">port</span><span class="p">:</span> <span class="mi">9000</span>
  <span class="n">accessKey</span><span class="p">:</span> <span class="n">worldsbestaccesskey</span>      
  <span class="n">secretKey</span><span class="p">:</span> <span class="n">worldsbestsecretkey</span>  
  <span class="n">ssl</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">bucket</span><span class="p">:</span> <span class="n">gleaner</span>
<span class="n">gleaner</span><span class="p">:</span>
  <span class="n">runid</span><span class="p">:</span> <span class="n">oih</span> <span class="c1"># this will be the bucket the output is placed in...</span>
  <span class="n">summon</span><span class="p">:</span> <span class="n">true</span> <span class="c1"># do we want to visit the web sites and pull down the files</span>
  <span class="n">mill</span><span class="p">:</span> <span class="n">true</span>
<span class="n">context</span><span class="p">:</span>
  <span class="n">cache</span><span class="p">:</span> <span class="n">true</span>
<span class="n">contextmaps</span><span class="p">:</span>
<span class="o">-</span> <span class="n">prefix</span><span class="p">:</span> <span class="s2">&quot;https://schema.org/&quot;</span>
  <span class="n">file</span><span class="p">:</span> <span class="s2">&quot;./jsonldcontext.json&quot;</span>  <span class="c1"># wget http://schema.org/docs/jsonldcontext.jsonld</span>
<span class="o">-</span> <span class="n">prefix</span><span class="p">:</span> <span class="s2">&quot;http://schema.org/&quot;</span>
  <span class="n">file</span><span class="p">:</span> <span class="s2">&quot;./jsonldcontext.json&quot;</span>  <span class="c1"># wget http://schema.org/docs/jsonldcontext.jsonld</span>
<span class="n">summoner</span><span class="p">:</span>
  <span class="n">after</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>      <span class="c1"># &quot;21 May 20 10:00 UTC&quot;   </span>
  <span class="n">mode</span><span class="p">:</span> <span class="n">full</span>  <span class="c1"># full || diff:  If diff compare what we have currently in gleaner to sitemap, get only new, delete missing</span>
  <span class="n">threads</span><span class="p">:</span> <span class="mi">1</span>
  <span class="n">delay</span><span class="p">:</span> <span class="mi">0</span>  <span class="c1"># milliseconds (1000 = 1 second) to delay between calls (will FORCE threads to 1) </span>
  <span class="n">headless</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">0.0.0.0</span><span class="p">:</span><span class="mi">9222</span>  <span class="c1"># URL for headless see docs/headless</span>
<span class="n">millers</span><span class="p">:</span>
  <span class="n">graph</span><span class="p">:</span> <span class="n">true</span>
  <span class="n">shacl</span><span class="p">:</span> <span class="n">false</span>
<span class="n">sitegraphs</span><span class="p">:</span>
<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">aquadocs</span>
  <span class="n">url</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">oih</span><span class="o">.</span><span class="n">aquadocs</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">aquadocs</span><span class="o">.</span><span class="n">json</span> 
  <span class="n">headless</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">pid</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">re3data</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">repository</span><span class="o">/</span><span class="n">aquadocs</span>
  <span class="n">properName</span><span class="p">:</span> <span class="n">AquaDocs</span>
  <span class="n">domain</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">aquadocs</span><span class="o">.</span><span class="n">org</span> 
<span class="n">sources</span><span class="p">:</span>
<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">marinetraining</span>
  <span class="n">url</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">marinetraining</span><span class="o">.</span><span class="n">eu</span><span class="o">/</span><span class="n">sitemap</span><span class="o">.</span><span class="n">xml</span>
  <span class="n">headless</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">pid</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">re3data</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">repository</span><span class="o">/</span><span class="n">marinetraining</span>
  <span class="n">properName</span><span class="p">:</span> <span class="n">Marine</span> <span class="n">Training</span> <span class="n">EU</span>
  <span class="n">domain</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">marinetraining</span><span class="o">.</span><span class="n">eu</span><span class="o">/</span>
<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">oceanexperts</span>
  <span class="n">url</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">oceanexpert</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">assets</span><span class="o">/</span><span class="n">sitemaps</span><span class="o">/</span><span class="n">sitemapTraining</span><span class="o">.</span><span class="n">xml</span>
  <span class="n">headless</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">pid</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">re3data</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">repository</span><span class="o">/</span><span class="n">oceanexpert</span>
  <span class="n">properName</span><span class="p">:</span> <span class="n">OceanExpert</span> <span class="n">UNESCO</span><span class="o">/</span><span class="n">IOC</span> <span class="n">Project</span> <span class="n">Office</span> <span class="k">for</span> <span class="n">IODE</span> 
  <span class="n">domain</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">oceanexpert</span><span class="o">.</span><span class="n">org</span><span class="o">/</span>
<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">obis</span>
  <span class="n">url</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">obis</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">sitemap</span><span class="o">/</span><span class="n">sitemap_datasets</span><span class="o">.</span><span class="n">xml</span>
  <span class="n">headless</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">pid</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">re3data</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">repository</span><span class="o">/</span><span class="n">obis</span>
  <span class="n">properName</span><span class="p">:</span> <span class="n">Ocean</span> <span class="n">Biodiversity</span> <span class="n">Information</span> <span class="n">System</span>
  <span class="n">domain</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">obis</span><span class="o">.</span><span class="n">org</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="run-gleaner">
<h4>Run gleaner<a class="headerlink" href="#run-gleaner" title="Permalink to this headline">¶</a></h4>
<p>For this example we are going to run Gleaner directly.  In a deployed instance you may
run Gleaner via a script or cron style service.  We will document that elsewhere.</p>
<p>We can do a quick test of the setup.</p>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> ./gleaner -cfg template_v2.0 -setup
</pre></div>
</div>
</div>
<p>For now, we are ready to run Gleaner.  Try:</p>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> ./gleaner -cfg template_v2.0
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Leave the suffix like .yaml off the name of the config file.  The config system can also read
json and other formats.  So simply leave the suffix off and let the config code inspect the
contents.</p>
</div>
</div>
</div>
<div class="section" id="load-results-to-a-graph-and-test">
<h3>Load results to a graph and test<a class="headerlink" href="#load-results-to-a-graph-and-test" title="Permalink to this headline">¶</a></h3>
<p>You have set up the server environment and Gleaner and done your run.  Things look good
but you don’t have a graph you can work with yet.    You need to load the JSON-LD into
the triplestore in order to start playing.</p>
<div class="section" id="minio-object-store">
<h4>Minio Object store<a class="headerlink" href="#minio-object-store" title="Permalink to this headline">¶</a></h4>
<p>To view the object store you could use your browser and point it on the default minio
port at 9000.  S typically something like localhost:9000.</p>
<p>If you wish to continue to use the command line you can use the Minio client at
<a class="reference external" href="https://docs.min.io/docs/minio-client-quickstart-guide.html">Minio Client Quickstart guide</a>.</p>
<p>Once you have it installed and working, you can write an entry for our object store with:</p>
<div class="tip admonition">
<p class="admonition-title">Command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> ./mc <span class="nb">alias</span> <span class="nb">set</span> minio http://0.0.0.0:9000 worldsbestaccesskey worldsbestsecretkey
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-triplestore">
<h4>Load Triplestore<a class="headerlink" href="#load-triplestore" title="Permalink to this headline">¶</a></h4>
<p>We now want to load these objects, which are JSON-LD files holding RDF based graph
data, into a graph database.  We use the term, triplestore, to define a graph database
designed to work with the RDF data model and provide SPARQL query support over that
graph data.</p>
<ul class="simple">
<li><p>Simple script loading</p></li>
<li><p>Nabu</p></li>
<li><p>Try out a simple SPARQL query</p></li>
</ul>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./indexing"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">Aggregator</a>
    <a class='right-next' id="next-link" href="indexingservices.html" title="next page">Indexing Services</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By IODEPO<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>